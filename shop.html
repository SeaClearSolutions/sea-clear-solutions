<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop - Sea Clear</title>
    <link rel="icon" type="image/png" href="Transparent.png">
    <link rel="stylesheet" href="shop.css">
    <script src="navbar.js" defer></script>
    <script src="mobile-navbar.js" defer></script>

     <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZMHXVC530F"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
      
        gtag('config', 'G-ZMHXVC530F');
    </script>
</head>

<body>
  <header>
    <nav class="navbar">
      <!-- Mobile: hamburger + cart -->
      <div class="nav-mobile-left">
        <button class="hamburger" aria-label="Menu">&#9776;</button>
      </div>

      <!-- Single centered logo for all views -->
      <div class="nav-logo logo-container">
        <img src="Transparent.png" alt="Sea Clear Logo" class="logo" />
      </div>
      
      <!-- Desktop nav -->
      <ul class="left desktop-only">
        <li><a href="index.html">Home</a></li>
        <li><a href="shop.html">Shop</a></li>
        <li><a href="about.html">About Us</a></li>
        <li><a href="wholesale.html">Wholesale</a></li>
        <li><a href="ambassadors.html">Ambassadors</a></li>
      </ul>

      <ul class="right desktop-only">
        <li><a href="contact.html">Contact Us</a></li>
      </ul>

      <!-- Mobile nav (hidden by default, shown with JS toggle) -->
      <ul class="mobile-nav">
        <li><a href="index.html">Home</a></li>
        <li><a href="shop.html">Shop</a></li>
        <li><a href="about.html">About Us</a></li>
        <li><a href="wholesale.html">Wholesale</a></li>
        <li><a href="ambassadors.html">Ambassadors</a></li>
        <li><a href="contact.html">Contact Us</a></li>
      </ul>
    </nav>
  </header>

<main class="shop">   
<!-- Cart Sidebar -->
<div id="cart-sidebar" class="cart-sidebar">
  <div class="cart-container">
    <button id="close-cart">&times;</button>
    <h2>Shopping Cart</h2>
    <ul id="cart-items"></ul>
    <p id="total-price">Total: 0 IDR</p>

    <!-- Wrap the two buttons inside this flex container -->
    <div id="cart-buttons">
      <button id="place-order">Place Order</button>
      <button id="clear-cart" class="cart-clear-btn">Clear All</button>
    </div>
  </div>
</div>

<section class="shop">
    <h1>Shop</h1>
    <p>Choose the perfect size for your adventures! Each bottle of <strong>Sea Clear</strong> is reef-friendly, biodegradable, and made with natural ingredients to keep your mask fog-free.</p>

    <div id="discount-section" style="text-align:center; margin: 30px 0;">
      <p style="font-size: 1.1em; color:#146f77; margin-bottom:10px;">
        Are you a dive center, resort, or retail partner? Enter your wholesale code below to view your special prices.
      </p>
    
      <label for="discount-code" style="font-weight:bold;">Wholesale Code:</label>
      <input type="text" id="discount-code" placeholder="Enter code" style="margin: 0 10px; padding: 6px 10px; border: 1px solid #237778; border-radius: 6px;">
      <button id="apply-discount-btn" style="padding: 6px 14px; background-color:#146f77; color:#fffee1; border:none; border-radius:6px; cursor:pointer;">
        Apply
      </button>
    
      <p id="discount-message" style="color:#146f77; margin-top:10px;"></p>
    
      <p class="wholesale-note" style="margin-top:15px; font-size:0.95em;">
        Don’t have a code yet? <a href="wholesale.html" style="color:#237778; text-decoration:underline;">Request your wholesale access here.</a>
      </p>
    </div>

<div class="products">
    <div class="product wholesale-only" style="display:none;">
    <img src="C.png" alt="Sea Clear 5L">
    <h2>Sea Clear - 5L</h2>
    <p>The best choice for large-scale operations—maximum value, minimal waste.</p>
    <p class="product-price" 
       data-name="Sea Clear - 5L" 
       data-original-price="0" 
       data-current-price="0">
       (Wholesale only)
    </p>
    <button class="add-to-cart" data-name="Sea Clear - 5L" data-price="0">Add to Cart</button>
  </div>

  <div class="product wholesale-only" style="display:none;">
    <img src="C.png" alt="Sea Clear 1L">
    <h2>Sea Clear - 1L</h2>
    <p>Bulk size for resorts and dive centers—ideal for frequent refills.</p>
    <p class="product-price" 
       data-name="Sea Clear - 1L" 
       data-original-price="0" 
       data-current-price="0">
       (Wholesale only)
    </p>
    <button class="add-to-cart" data-name="Sea Clear - 1L" data-price="0">Add to Cart</button>
  </div>
    
  <div class="product">
    <img src="C.png" alt="Sea Clear 500ml">
    <h2>Sea Clear - 500ml</h2>
    <p>Perfect for dive shops and avid divers. More defog, less waste!</p>
    <p class="product-price" 
       data-name="Sea Clear - 500ml" 
       data-original-price="1000000" 
       data-current-price="1000000">
       1,000,000 IDR
    </p>
    <button class="add-to-cart" data-name="Sea Clear - 500ml" data-price="1000000">Add to Cart</button>
  </div>

  <div class="product">
    <img src="C.png" alt="Sea Clear 250ml">
    <h2>Sea Clear - 250ml</h2>
    <p>Great for frequent divers who want a long-lasting supply.</p>
    <p class="product-price" 
       data-name="Sea Clear - 250ml" 
       data-original-price="550000" 
       data-current-price="550000">
       550,000 IDR
    </p>
    <button class="add-to-cart" data-name="Sea Clear - 250ml" data-price="550000">Add to Cart</button>
  </div>

  <div class="product">
    <img src="C.png" alt="Sea Clear 100ml">
    <h2>Sea Clear - 100ml</h2>
    <p>A compact size for personal use—easy to carry on dive trips.</p>
    <p class="product-price" 
       data-name="Sea Clear - 100ml" 
       data-original-price="230000" 
       data-current-price="230000">
       230,000 IDR
    </p>
    <button class="add-to-cart" data-name="Sea Clear - 100ml" data-price="230000">Add to Cart</button>
  </div>

  <div class="product">
    <img src="C.png" alt="Sea Clear 60ml">
    <h2>Sea Clear - 60ml</h2>
    <p>Fits right into your dive bag! Ideal for regular but light use.</p>
    <p class="product-price" 
       data-name="Sea Clear - 60ml" 
       data-original-price="150000" 
       data-current-price="150000">
       150,000 IDR
    </p>
    <button class="add-to-cart" data-name="Sea Clear - 60ml" data-price="150000">Add to Cart</button>
  </div>

  <div class="product">
    <img src="C.png" alt="Sea Clear 30ml">
    <h2>Sea Clear - 30ml</h2>
    <p>Small but mighty! The perfect travel-size defog solution.</p>
    <p class="product-price" 
       data-name="Sea Clear - 30ml" 
       data-original-price="90000" 
       data-current-price="90000">
       90,000 IDR
    </p>
    <button class="add-to-cart" data-name="Sea Clear - 30ml" data-price="90000">Add to Cart</button>
  </div>

  <p class="wholesale-note"></p>
</div>

    </div>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const discountInput = document.getElementById("discount-code");
      const discountButton = document.getElementById("apply-discount-btn");
      const discountMessage = document.getElementById("discount-message");
    
      // helper used by both scripts: exact wholesale mapping
     function getWholesalePrice(name, originalPrice) {
      if (name.includes("30ml")) return 45000;
      if (name.includes("60ml")) return 80000;
      if (name.includes("100ml")) return 125000;
      if (name.includes("250ml")) return 300000;
      if (name.includes("500ml")) return 600000;
      if (name.includes("1L")) return 1150000;   // ✅ your wholesale 1L price
      if (name.includes("5L")) return 5000000;   // ✅ your wholesale 5L price
      return originalPrice;
    }

    
      // load saved code (if any) and apply it on page load
      let savedCode = localStorage.getItem("discountCode") || "";
      if (savedCode) {
        discountInput.value = savedCode;
        applyDiscount(savedCode);
      }
    
      discountButton.addEventListener("click", function() {
        const code = discountInput.value.trim().toUpperCase();
        localStorage.setItem("discountCode", code);
        applyDiscount(code);
      });
    
      function applyDiscount(code) {
        const priceElements = document.querySelectorAll(".product-price");
        let validCode = false;
    
        priceElements.forEach(el => {
          const name = el.dataset.name;
          const original = parseInt(el.dataset.originalPrice, 10) || 0;
          let discounted = original;
    
          // === codes and mapping ===
          const wholesaleCodes = ["AMBASSADORS","SREPUBLIC","BDRESORT", "SEACREATURES", "SORCE"];
          if (wholesaleCodes.includes(code)) {
            validCode = true;
            discounted = getWholesalePrice(name, original);
          } else if (code === "DDIVERS") {
            validCode = true;
            discounted = Math.round(original * 0.5 / 1000) * 1000;
          }
    
          // set visible and stored values
          el.textContent = discounted.toLocaleString() + " IDR";
          el.dataset.currentPrice = discounted;
          // also keep original price stored (just in case)
          el.dataset.originalPrice = original;
        });
    
     if (validCode) {
      localStorage.setItem("isWholesale", "true");
      discountMessage.textContent = "Discount code applied: " + code;
      discountMessage.style.color = "#146f77";
    
      // ✅ Show wholesale-only products when valid wholesale code is applied
      document.querySelectorAll(".wholesale-only").forEach(el => {
        el.style.display = "block";
        const priceEl = el.querySelector(".product-price");
        const name = priceEl.dataset.name;
        const wholesalePrice = getWholesalePrice(name, 0);
        if (wholesalePrice > 0) {
          priceEl.textContent = wholesalePrice.toLocaleString() + " IDR";
          priceEl.dataset.currentPrice = wholesalePrice;
          el.querySelector(".add-to-cart").dataset.price = wholesalePrice;
        }
      });
    
    } else {
      localStorage.removeItem("isWholesale");
      discountMessage.textContent = "Invalid code — showing regular prices.";
      discountMessage.style.color = "red";
      localStorage.removeItem("discountCode");
    
      // ✅ Hide wholesale-only products again if code is invalid
      document.querySelectorAll(".wholesale-only").forEach(el => {
        el.style.display = "none";
      });
    }
          
        // Sync Add-to-Cart buttons to use the updated price
        document.querySelectorAll(".add-to-cart").forEach(btn => {
          const product = btn.dataset.name;
          const priceEl = document.querySelector(`.product-price[data-name="${product}"]`);
          if (priceEl) {
            btn.dataset.price = priceEl.dataset.currentPrice || priceEl.dataset.originalPrice || btn.dataset.price;
          }
        });
    
        // Debug: show what was set (open console to inspect)
        console.log("applyDiscount:", { code, isWholesale: localStorage.getItem("isWholesale"), discountCode: localStorage.getItem("discountCode") });
        document.querySelectorAll(".product-price").forEach(el => {
          console.log(el.dataset.name, "orig:", el.dataset.originalPrice, "current:", el.dataset.currentPrice);
        });
      }
    });
    </script>
</section>

<footer>
    <img src="Transparent.png" alt="Sea Clear Logo" class="footer-logo">
    <h2><strong>Made with Care in Bali</strong></h2>
<p>Made in Bali by a reputable manufacturer committed to ethical and safe production.</p>
    </footer>

<script src="script.js"></script>
</main>
</body>
</html>
